# NABIS 균형발전지표 XLS 파일 구조

- [1. 파일 구성](#1-파일-구성)
- [2. XLS 파일 내부 구조](#2-xls-파일-내부-구조)
- [3. 열 구조 (22열)](#3-열-구조-22열)
- [4. 지표 목록 (46개)](#4-지표-목록-46개)
- [5. 데이터 특성 및 주의사항](#5-데이터-특성-및-주의사항)
- [6. 파싱 가이드](#6-파싱-가이드)

---

## 1. 파일 구성

```
datasets/index2025-claude/
├── {시도명}/
│   ├── {시도명}.xls        ← 시도 단위 데이터
│   ├── {시군구명}.xls      ← 시군구 단위 데이터
│   └── ...
└── ...
```

- **총 파일 수**: 약 267개 (시도 17 + 시군구 ~250)
- **형식**: `.xls` (Excel 97-2003 구형 바이너리, xlrd로 파싱)
- **시도·시군구 파일 형식 완전 동일** — 열 구조와 지표 목록이 같음

---

## 2. XLS 파일 내부 구조

- **시트 수**: 1개
- **행 수**: 52행 (헤더 6행 + 데이터 46행)
- **열 수**: 22열

### 행 구성

| 행 번호 | 내용 |
|---------|------|
| 0 | 제목행 — `핵심.객관지표(지차체 2021~2025년)_{시도명}` 또는 `..._{시도명}_{시군구명}` |
| 1 ~ 3 | 빈 행 (3행) |
| **4** | **헤더 1단** — 순번, 지표구분, 부문, 지표명, 단위, 시도, 시군구, `2025 발표`(×3), `2024 발표`(×3), `2023 발표`(×3), `2022 발표`(×3), `2021 발표`(×3) |
| **5** | **헤더 2단** — (앞 7열 공백), 이후 각 발표연도 그룹마다 `지자체 / 전국 / 기준년도` 반복 |
| **6 ~ 51** | **데이터 46행** — 지표 순번 1~46 |

> **파싱 시작점**: 행 6부터 읽으면 됨 (행 4~5는 2단 헤더로 직접 조합 필요)

---

## 3. 열 구조 (22열)

```
col  0  순번           (float: 1.0 ~ 46.0)
col  1  지표구분       (str: '핵심지표' / '객관지표')
col  2  부문           (str: '핵심지표' / '인구' / '교육' / ... 10개 부문)
col  3  지표명         (str)
col  4  단위           (str, 일부 공백 '')
col  5  시도           (str: 시도명)
col  6  시군구         (str: 시도 파일은 시도명, 시군구 파일은 시군구명)

── 2025 발표 ──────────────────────────────
col  7  지자체 값      (str: 숫자 또는 '-')
col  8  전국 평균      (str: 숫자 또는 '-')
col  9  기준년도       (str: ex. '2024년', '(2020~2024)', '-')

── 2024 발표 ──────────────────────────────
col 10  지자체 값
col 11  전국 평균
col 12  기준년도

── 2023 발표 ──────────────────────────────
col 13  지자체 값
col 14  전국 평균
col 15  기준년도

── 2022 발표 ──────────────────────────────
col 16  지자체 값
col 17  전국 평균
col 18  기준년도

── 2021 발표 ──────────────────────────────
col 19  지자체 값
col 20  전국 평균
col 21  기준년도
```

### 시도 vs 시군구 구분 방법

`col 5 (시도)` ≠ `col 6 (시군구)` 이면 시군구 파일, 같으면 시도 파일.

---

## 4. 지표 목록 (46개)

| 순번 | 지표구분 | 부문 | 지표명 | 단위 |
|------|----------|------|--------|------|
| 1 | 핵심지표 | 핵심지표 | 최근 5년 연평균 인구증감률 | % |
| 2 | 핵심지표 | 핵심지표 | 재정자립도 3개년 평균 | % |
| 3 | 객관지표 | 인구 | 인구증감률 | % |
| 4 | 객관지표 | 인구 | 합계출산율 | 가임여성1명당 명 |
| 5 | 객관지표 | 인구 | 조사망률 | 1천명당 명 |
| 6 | 객관지표 | 인구 | 등록외국인수 | 명 |
| 7 | 객관지표 | 인구 | 고령화지수 | 명 |
| 8 | 객관지표 | 인구 | 청년층순이동률 | % |
| 9 | 객관지표 | 교육 | 어린이집 및 유치원 서비스권역내 영유아인구 비율 | % |
| 10 | 객관지표 | 교육 | 초등학교 서비스권역 내 학령인구 비율 | % |
| 11 | 객관지표 | 교육 | 고등교육기관 졸업자의 취업률 | % |
| 12 | 객관지표 | 교육 | 인구 만명당 비형식 평생교육기관의 수 | 개소 |
| 13 | 객관지표 | 주거 및 교통 | 노후주택비율 | % |
| 14 | 객관지표 | 주거 및 교통 | 대중교통수송분담률 | % |
| 15 | 객관지표 | 주거 및 교통 | 직주근접성 | (무단위) |
| 16 | 객관지표 | 문화여가 | 공공도서관 서비스권역 내 인구비율 | % |
| 17 | 객관지표 | 문화여가 | 공공체육시설 서비스권역 내 인구비율 | % |
| 18 | 객관지표 | 문화여가 | 지자체 예산 중 문화예산 비율 | % |
| 19 | 객관지표 | 안전 | 소방서 접근성 | km |
| 20 | 객관지표 | 안전 | 경찰서 접근성 | km |
| 21 | 객관지표 | 안전 | 구조구급대원 1인당 담당주민수 | 주민수/구조구급대원1명 |
| 22 | 객관지표 | 안전 | 119안전센터 1개당 담당주민수 | 주민수/119안전센터1개 |
| 23 | 객관지표 | 안전 | 지진옥외대피소 | (무단위) |
| 24 | 객관지표 | 생활환경 | 하수도보급률 | % |
| 25 | 객관지표 | 생활환경 | 생활권공원 서비스권역 내 인구 비율 | % |
| 26 | 객관지표 | 생활환경 | 행정구역면적(1㎢)당 대기오염물질배출량 | 톤/㎢·년 |
| 27 | 객관지표 | 생활환경 | 생활계폐기물 재활용 비율 | % |
| 28 | 객관지표 | 생활환경 | 행정구역면적 대비 공원면적비 | % |
| 29 | 객관지표 | 생활환경 | 주민1인당 생활폐기물 발생량 | kg/명 |
| 30 | 객관지표 | 보건복지 | 국민기초생활보장수급자비율 | % |
| 31 | 객관지표 | 보건복지 | 지자체 보건 및 사회복지 분야 예산 | % |
| 32 | 객관지표 | 보건복지 | 인구 십만명당 사회복지시설수 | 개소/십만명 |
| 33 | 객관지표 | 보건복지 | 응급의료시설 서비스권역 내 인구비율 | % |
| 34 | 객관지표 | 보건복지 | 병원 서비스권역 내 인구 비율 | % |
| 35 | 객관지표 | 산업·일자리 | 최근 3개년 사업체수 증감률 | % |
| 36 | 객관지표 | 산업·일자리 | 최근 3개년 종사자수 증감률 | % |
| 37 | 객관지표 | 산업·일자리 | 경제활동참가율 | % |
| 38 | 객관지표 | 산업·일자리 | 연구원당 연구개발비 | 천원/연구개발인력1명 |
| 39 | 객관지표 | 산업·일자리 | 지식기반산업집적도 3개년 평균 | (무단위) |
| 40 | 객관지표 | 산업·일자리 | 최근 3개년 창업기업수 증감률 | % |
| 41 | 객관지표 | 생산·분배 | 지역내총생산 | 단위: 백만원 |
| 42 | 객관지표 | 생산·분배 | 지역내 무역거래량 | (무단위) |
| 43 | 객관지표 | 생산·분배 | 지역내소비 | 단위: 백만원 |
| 44 | 객관지표 | 물가·재정 | 소비자물가상승률 | % |
| 45 | 객관지표 | 물가·재정 | 지가변동률 | % |
| 46 | 객관지표 | 물가·재정 | 재정자립도 | % |

### 부문별 지표 수

| 부문 | 지표 수 | 순번 |
|------|---------|------|
| 핵심지표 | 2 | 1~2 |
| 인구 | 6 | 3~8 |
| 교육 | 4 | 9~12 |
| 주거 및 교통 | 3 | 13~15 |
| 문화여가 | 3 | 16~18 |
| 안전 | 5 | 19~23 |
| 생활환경 | 6 | 24~29 |
| 보건복지 | 5 | 30~34 |
| 산업·일자리 | 6 | 35~40 |
| 생산·분배 | 3 | 41~43 |
| 물가·재정 | 3 | 44~46 |

---

## 5. 데이터 특성 및 주의사항

### 값 타입

모든 데이터 셀 값은 **문자열(str)** 로 저장됨. 숫자 계산 시 float 변환 필요.

```python
val = ws.cell_value(r, 7)   # str: '-0.70' 또는 '-'
if val != '-':
    numeric = float(val.replace(',', ''))
```

### 결측값 (`-`)

데이터 없음을 나타내는 문자열 `'-'` 사용. 연도별 결측 비율 예시:

| 파일 유형 | 2025 | 2024 | 2023 | 2022 | 2021 |
|-----------|------|------|------|------|------|
| 시도 (서울특별시) | 4/46 | 3/46 | 11/46 | 1/46 | 3/46 |
| 도시 시군구 (종로구) | 13/46 | 14/46 | 25/46 | 15/46 | 14/46 |
| 농촌 시군구 (인제군) | 13/46 | 15/46 | 25/46 | 15/46 | 13/46 |

> **특징**: 시도 파일이 시군구 파일보다 결측 적음. 2023 발표 데이터가 특히 결측 많음 (공표 주기 차이 추정).

### 기준년도 형식 다양

같은 발표연도라도 지표마다 기준년도 형식이 다름:

- 단년도: `'2024년'`, `'2023년'`
- 범위: `'(2020~2024)'`, `'(2019~2021)년'`
- 평균: `'(2021~2023년)'`, `'(2020~2022) 평균년'`
- 없음: `'-'`, `''`

### 전국 평균 vs 지자체 값

- `col 7` (지자체) + `col 8` (전국) 쌍으로 비교 분석 가능
- 전국 평균도 동일하게 `-`로 결측 표시

### 주의: 단위 없는 지표

`col 4 (단위)` 가 빈 문자열 `''` 인 지표: 순번 15 (직주근접성), 23 (지진옥외대피소), 39 (지식기반산업집적도), 42 (지역내 무역거래량)

---

## 6. 파싱 가이드

### 단일 파일에서 지표별 최신값 추출

```python
import xlrd

def parse_xls(path, target_year_col=7):
    """
    path: XLS 파일 경로
    target_year_col: 추출할 발표연도 열 (7=2025, 10=2024, 13=2023, 16=2022, 19=2021)
    """
    wb = xlrd.open_workbook(path)
    ws = wb.sheet_by_index(0)

    records = []
    for r in range(6, ws.nrows):   # 행 6~51
        sido   = ws.cell_value(r, 5)
        sgg    = ws.cell_value(r, 6)
        name   = ws.cell_value(r, 3)
        unit   = ws.cell_value(r, 4)
        val    = ws.cell_value(r, target_year_col)      # 지자체 값
        nat    = ws.cell_value(r, target_year_col + 1)  # 전국 평균
        ref_yr = ws.cell_value(r, target_year_col + 2)  # 기준년도

        records.append({
            "순번":    int(ws.cell_value(r, 0)),
            "지표구분": ws.cell_value(r, 1),
            "부문":    ws.cell_value(r, 2),
            "지표명":  name,
            "단위":    unit,
            "시도":    sido,
            "시군구":  sgg,
            "지자체값": None if val == '-' else float(val.replace(',', '')),
            "전국평균": None if nat == '-' else float(nat.replace(',', '')),
            "기준년도": ref_yr,
        })
    return records
```

### 발표연도 열 인덱스 매핑

```python
YEAR_COL = {
    "2025": 7,
    "2024": 10,
    "2023": 13,
    "2022": 16,
    "2021": 19,
}
```

### 전체 파일 일괄 로드 예시

```python
import os, xlrd

base = "datasets/index2025-claude"
all_records = []

for sido in os.listdir(base):
    sido_dir = os.path.join(base, sido)
    if not os.path.isdir(sido_dir):
        continue
    for fname in os.listdir(sido_dir):
        if not fname.endswith(".xls"):
            continue
        path = os.path.join(sido_dir, fname)
        all_records.extend(parse_xls(path))
```
