# V-World 시군구 Shapefile 분석 및 NABIS 연계 검토

## 1. 개요
NABIS 대시보드의 지도 시각화를 위해 다운로드 한 V-World 시군구 경계 데이터(`BND_SIGUNGU_PG`) 및 '센서스 공간정보 지역 코드(Excel)' 파일의 구조를 분석하여, NABIS 관련 통계와의 연동 가능성을 검토한 결과입니다. 

검토는 `/python-env` 워크플로우를 따라 구성된 `uv` 가상환경(Python 3.12) 상에서 `pandas` 및 `geopandas`를 활용하여 수행되었습니다.

## 2. 원본 데이터 구조 확인

### 2.1 시군구 경계 데이터 (Shapefile DBF)
Shapefile의 속성 데이터는 다음과 같은 구조를 가지고 있습니다.
- **BASE_DATE**: 기준일자 (예: `20250630`)
- **SIGUNGU_CD**: 5자리 시군구코드 (예: `11010`) 
  - *특징: 앞의 2자리(`11`)는 시도코드(서울특별시)를 의미하고, 뒤의 3자리(`010`)는 시군구 고유코드로 구성되어 있습니다.*
- **SIGUNGU_NM**: 시군구명 (예: `종로구`)
- **geometry**: 화면에 지역을 그리기 위한 폴리곤 데이터

### 2.2 센서스 공간정보 지역 코드 (Excel)
지역 통계와 명칭을 매핑하기 위한 계층적 코드를 포함하고 있습니다.
- **구조 특이사항**: 파일의 첫 번째 행에 '2025년6월 행정구역 코드'라는 제목이 병합되어 있어, 코드로 읽어들일 때 `header=1`로 읽어야 정상적인 컬럼(시도코드, 시도명칭, 시군구코드, 시군구명칭 등)이 인식됩니다.
- **예시**: `시도코드: 11` (서울특별시) / `시군구코드: 11010` (종로구)

## 3. NABIS 데이터와의 연계성 검토 결과
**결론: 제시된 Shapefile과 엑셀 매핑 데이터를 통해 NABIS 통계 대시보드 구현이 매우 효과적으로 가능합니다.**

**[주요 연계 방안 및 시사점]**
1. **완벽한 계층 구조(Drill-down) 구현**:
   - Shapefile의 `SIGUNGU_CD`(5자리)를 파싱하여 앞 2자리를 엑셀의 '시도코드'와 매칭하면, 해당 기초지자체(시군구)가 어느 광역지자체(17개 시도)에 속하는지 명확하게 분류할 수 있습니다. 
   - 이를 통해 대시보드 좌측 계층형 트리(`jstree`)를 렌더링하고, 클릭 시 지역 단위로 필터링하는 기능을 완벽히 구현할 수 있습니다.
2. **NABIS 데이터 Join Key 활용**:
   - NABIS의 통계 테이블 내의 '지역명(예: 서울특별시, 종로구)' 텍스트 또는 고유 식별 코드를 활용해, 검토된 Shapefile 데이터 프레임과 `Merge` 처리가 가능합니다. 
   - 일치된 데이터를 바탕으로 코로플레스 맵(지역별 색상 농도로 수치를 나타내는 지도)을 시각화하게 됩니다.
3. **웹 환경을 위한 경량화 필요성 (매우 중요)**:
   - 현재 `BND_SIGUNGU_PG.shp` 파일은 원본 크기가 **약 97MB**로, 이를 프론트엔드(React/D3.js 등)에 바로 올리게 되면 웹 브라우저 렌더링 지연과 메모리 과부하가 발생합니다.
   - 따라서 프론트엔드 통합 전에 이 공간 데이터를 **TopoJSON 포맷으로 변환하고 폴리곤 형상을 단순화(Simplify)** 하는 백엔드 데이터 가공 스크립트 작성 작업(전처리 작업) 과정이 구현 계획에 반드시 포함되어야 합니다.

## 4. 제안하는 다음 작업 단계 (Next Steps)
제안된 구현 계획(Implementation Plan)에 더하여 아래 데이터 가공 단계를 추가 진행하는 것을 권장합니다.

1. **데이터 전처리 파이프라인 구성 (`python`)**: 
   - Shapefile(shp) -> GeoJSON -> TopoJSON 구조로 압축/변환하는 파이썬 스크립트 작성 (지도의 윤곽선을 유지하면서 파일 용량을 1MB~3MB 내외로 축소).
2. **지역 코드 마스터 JSON 생성**: 
   - 엑셀 파일을 읽어 프론트엔드(UI 트리 구성)에서 직접 소모하기 편한 경량화된 1개의 JSON 파일(상하위 계층 포함)로 변환 배치.
